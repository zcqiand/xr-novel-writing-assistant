# Decision Log

This file records architectural and implementation decisions using a list format.
2025-08-13 00:23:49 - Log of updates made.

2025-08-13 00:23:49 - 文件创建

## 决策：实现四阶段故事生成流程

## 决策依据 

*   用户需求要求完整的小说生成流程
*   分阶段生成可提高系统可靠性和用户体验

## 实现细节

*   使用状态机管理生成阶段
*   每个阶段对应独立的API端点
*   前端通过进度条展示生成进度

2025-08-13 00:19:40 - 完成四阶段故事生成流程实现，包括状态管理、API路由和进度指示器

2025-08-13 00:25:37 - 修复API路由JSON解析错误，实现条件性请求体解析

2025-08-13 01:38:21 - 修复API端点400错误：发现并解决前端后端数据结构不匹配问题，修复paragraphs和full阶段的API调用

2025-08-13 02:54:40 - 决策修复书籍名称硬编码问题：修改AI大纲生成提示词要求AI生成书籍名称，更新StoryOutline接口添加title字段，修改所有文件保存路径使用动态生成的书籍名称

2025-08-13 03:06:40 - 决策修复JSON schema缺少title字段的问题：更新generateStoryOutline方法中的JSON schema定义，添加title字段并设置为必需字段，确保AI能正确返回书籍标题

2025-08-13 03:10:41 - 决策修复generateChapterScenes函数文件名问题：更新generateChapterScenes函数中的文件保存路径，使用动态书籍名称作为前缀，确保所有生成的文件都使用统一的命名规范

2025-08-13 03:20:54 - 决策修复故事大纲文件未保存的问题：更新generateStoryOutline函数，添加保存大纲到data目录的逻辑，使用动态文件名，确保所有生成的文件都保存到data目录

2025-08-13 04:24:00 - 修复章节标题生成问题：决定更新AI大纲生成提示词，要求AI为每个章节生成吸引人的标题，并更新相关数据结构和处理函数以支持章节标题的正确显示和使用